<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TogetherSafe – SOS</title>

  <!-- Global cinematic stylesheet -->
  <link rel="stylesheet" href="/styles.css">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="icons/sos.png" />
</head>

<body>
  <header>
    <h2>SOS</h2>
    <small>Choose what you need right now</small>
  </header>

  <main>
    <button class="sos-card lvl1" onclick="triggerSOS('bathroom_rescue')">
      <div class="sos-title">Bathroom rescue</div>
      <div class="sos-sub">Quiet alert. Ask your group to come get you.</div>
    </button>

    <button class="sos-card lvl2" onclick="triggerSOS('check_on_me')">
      <div class="sos-title">Check on me</div>
      <div class="sos-sub">Set a timer. If you don’t respond, your group is alerted.</div>
    </button>

    <button class="sos-card lvl3" onclick="triggerSOS('too_drunk')">
      <div class="sos-title">Too drunk / need help</div>
      <div class="sos-sub">High-priority alert. You need support now.</div>
    </button>

    <button class="sos-card lvl4" onclick="confirmRoofied()">
      <div class="sos-title">Roofied / medical danger</div>
      <div class="sos-sub">Critical alert. Loud, repeated, and escalated.</div>
    </button>

    <button class="sos-card lvl5" onclick="triggerSOS('call_me')">
      <div class="sos-title">Call me in 2 minutes</div>
      <div class="sos-sub">Ask someone to call you as an exit.</div>
    </button>

    <button class="sos-card lvl6" onclick="triggerSOS('going_home')">
      <div class="sos-title">I’m going home</div>
      <div class="sos-sub">Let your group know you’re heading home.</div>
    </button>
  </main>

  <nav>
    <button onclick="goToHome()">Home</button>
    <button onclick="goToSOS()">SOS</button>
    <button onclick="goToProfile()">Profile</button>
    <button onclick="goToSettings()">Settings</button>
  </nav>

  <!-- Load PocketBase browser SDK FIRST -->
  <script src="https://unpkg.com/pocketbase/dist/pocketbase.umd.js"></script>

  <!-- Then load your global app logic -->
  <script src="app.js"></script>

  <script>
    async function triggerSOS(type) {
      const result = await window.App.sendSOS(type);
      alert(result.message);
    }

    function confirmRoofied() {
      if (confirm("Send critical SOS: Roofied / medical danger?")) {
        triggerSOS("roofied");
      }
    }

    function goToHome() { window.location.href = "home.html"; }
    function goToSOS() { window.location.href = "sos.html"; }
    function goToProfile() { window.location.href = "profile.html"; }
    function goToSettings() { window.location.href = "settings.html"; }
  </script>
</body>
</html>
